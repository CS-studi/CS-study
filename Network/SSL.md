# 🔒 SSL
### 📚 Table of contents
> SSL과 TLS

> 공개키(비대칭키), 비공개키(대칭키)

> SSL 동작방식

> SSL handshake

## 🔑 SSL과 TLS
SSL(Secure Sockets Layter)와 TLS(Transport Layer Security)은 같은 것이라고 할 수 있다. SSL은 TCP/IP 암호화 통신에서 사용되는 규약이고 SSL 3.0 버전 이후에는 IETF에서 TLS 1.0으로 규정했습니다.

암호화는 텍스트를 누구나 읽지 못하도록 하기위해서 암호화하는 알고리즘이며 키는 암호화 동작을 변경하는 매객변수 역할을 하며 키에 따라서 암호가 달라지므로 키를 모르면 복호화가 불가능하다. 

SSL 암호화 방법
- 대칭키
- 공개키

## 공개키 암호화 (비대칭키 암호 알고리즘)
> ![public](img/Http_https/Publickey.png)

공개키 암호화 방식은 두개의 키를 사용한다. 두 키중에서 하나를 개인키(private key, 비공개키)라고 하며 나머지 하나를 공개키(public key)라고 한다. 공개키로 암호화하고 공개키와 매칭되는 개인키로만 복화할 수 있으며, 공개키는 누구든지 알아도 상관 없고, 개인키는 복호화하는 쪽만 알 수 있도록 해야 한다.

쉽게 말해서 `암호화할 때와 복호화할 때 이용하는 키가 다른 키, 비대칭인 암호화 방식이 공개키 암호화이다.`


### 공개키 암호화 종류(참고)
- RSA
- ElGamal
- ECC(Eliptic Curve Crytosystems)
- Digital Signature(전자서명)

### 공개키 암호화와 전자서명의 비밀키와 공개키의 역할은 다르다.
공개키 암호화 방식은 두 키를 사용한다. 대략적으로 말하면 암호화(평문 암호화)만 할 수 있는 키(공개키), 그리고 복호화(암호문을 평문으로)만 할 수 있는키(비밀키, 비공개키)를 구분하여 공통키 암호방식의 문제인 운송문제를 해결하는 방법입니다.
공개키 알고리즘
```
1. 키 생성 ...암호화 키 E(공개키)와 복호화 키 D(비밀키)를 준비한다.
2. 암호화  ...암호화 키 E를 사용하여 평문 M을 암호문 C로 변환 할 수 있다.
3. 복호화  ...복호화 키 D를 사용하여 암호문 C를 평문 M으로 변환할 수 있다.
```

전자서명의 비밀키는 `평문을 사용하여 서명`하기 위한 것이고, 공개키는 `서명이 올바른지 검증`하는 것이다. 즉 공개키 암호화에서의 비밀키와 공개키의 역할과는 전혀 다르다.

> ![CA](img/Http_https/CA.png)

```
1. B는 CA에게 자신이 B임을 증명하고 자신의 공개키가 B의 공개키가 맞음을 인증하는 인증서 발급한다.
2. A에게 B의 공개키가 포함된 이 인증서를 준다.
3. 이를 받은 A는 자신이 신뢰할 수 있는 CA에게 CA가 발급한 인증서인지 확인한다.
4. 맞으면 그 인증서에 포함된 B의 공개키로 데이터를 암호화해서 B에게 전달한다.
```

## 비공개키 암호화
>![private](img/Http_https/Privatekey.png)

비대칭키와는 반대로 대칭키라고 한다. a, b사이에 private key 1개를 공유하고 그 키를 통해서 암호화 복호화한다. 만약에 "ABCD"라는 키로 암호화를 하면 복호화시에 "ABCD"를 입력해야한다. 대칭키를 누군가 도청하거나, 유출된다면 암호화된 데이터를 알아낼 수 있다. 비공개키의 하나의 종류로 블록 암호 알고리즘이 있다. 대칭키 알고리즘으로 암,복호화 시 데이터를 블록 단위로 처리하는 알고리즘으로 SSL/TLS에서 많이 사용된다.

## 대칭키 비대칭키 암호화 장단점
대칭키 암호화는 서버와 클라이언트가 같은 키를 사용해야 하므로 키를 공유하는데 문제가 있고, 비대칭키 암호화는 공개키를 배포함으로써 키 공유 문제는 해결되지만, 처리 속도가 느린 문제가 있다. HTTPS 통신에서 실제 전송되는 데이터의 암호화에는 대칭키 암호화 방식을 사용하고, 키 교환에는 비대칭키 암호화를 사용하여 이러한 문제를 해결하고 있다.


## SSL 동작 방식
SSL의 동작 방식을 알기 위해서는 인증기관에 대하여 알아야 한다. 

### 🏢 인증 기관(Certification Authority)
HTTPS 통신에서는 제3자 인증을 사용한다. 인증기관 CA로부터 공인 인증서를 발급받아서 서버에 설치해야 경고 없이 HTTPS 통신을 할 수 있다. 인증기관의 인증을 받았다는 것은 웹 서비스를 제공하는 소유자를 보증해준다는 의미이다. 자세히는 웹 서비스 제공자의 공개키가 키 소유자의 것이라는 것을 보증해주는 것이다.

HTTPS로 웹서비스를 제공하려는 사람은 자신의 공개키와 개인키를 생성하고, 공개키를 인증기관에 보낸다. 인증기관에서는 보내온 공개키, 유효기간, 도메인 등의 정보를 포함하여 인증기관의 개인키로 전자서명한 인증서를 발급한다.

웹서비스 제공자는 발급받은 인증서와 자신의 개인키를 웹서버에 설정하여 HTTPS 통신을 할 수 있게 된다.

클라이언트 즉, 웹 브라우저에는 이미 여러 인증기관의 공개키를 포함한 인증서가 이미 설치되어 있다. 그래서 웹서버와 통신시 인증기관의 개인키로 서명된 인증서를 받았을 때 이미 설치되어 있는 인증기관의 공개키로 복호화가 가능한 것이다.

---
인증기관으로부터 인증서를 발급받아서 웹서버에 설치하고 HTTPS 통신이 가능한 상태라고 가정한다.

1. 사용자가 웹브라우저로 사이트에 접속하면 웹서버는 인증서를 웹 브라우저에게 보낸다. 이 인증서에는 인증기관의 개인키로 암호화된 사이트의 정보와 공개키가 들어있다.
2. 웹 브라우저는 이미 가지고 있는 인증기관의 공개키로 웹 서버에서 받은 인증서를 복호화해서 확인한다.
3. 웹 브라우저는 실제 데이터의 암호화에 사용될 대칭키를 생성하고, 인증서에서 꺼낸 웹 서버 측의 공개키로 암호화해서 웹 서버로 보낸다.
4. 웹 서버는 자신이 가지고 있는 개인키로 웹 브라우저가 보내온 대칭키를 복호화해서 얻습니다. 이제 이 대칭키로 데이터를 암호화해서 주고 받게 된다.

실제 데이터 전송을 위해 웹 브라우저가 지원하는 암호화 방식과 서버가 지원하는 암호화하는 방식들 중 둘 다 지원하는 암호화 방식을 선택하는 등의 많은 작업이 있고, 키 교환도 다른 방식이 있을 수 있다.

> 내일 이어서 정리

### 참고
[SSL동작 방식](https://blog.naver.com/PostView.nhn?isHttpsRedirect=true&blogId=leejongcheol2018&logNo=221449123851)
<br>

[공개키 암호 방식](https://ko.wikipedia.org/wiki/%EA%B3%B5%EA%B0%9C_%ED%82%A4_%EC%95%94%ED%98%B8_%EB%B0%A9%EC%8B%9D)
<br>

[전자서명과 공개키암호화의 차이](https://perfectmoment.tistory.com/2098)
<br>

[SSL handshake](https://reakwon.tistory.com/106)
***

## 🍉 Summary

## ⁉️ 면접 예상 질문
> 1. SSL과 TLS에 대해서 설명하시오.

> 2. 공개키 암호화 알고리즘에 대해서 설명하시오.

> 3. SSL 동작 방식은 어떻게 되나요?

