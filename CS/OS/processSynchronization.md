# ğŸ« Process Synchronization

> Intro

> ë™ê¸°í™”(Synchronization)

> Race Conditions

> Critical Region

> í•´ê²°ì±…

> Mutex & Semaphore

>> Lock

>> Semaphores

>> Monitor



## ğŸ« Intro

### Processë€ ë¬´ì—‡ì¸ê°€?
> í”„ë¡œì„¸ìŠ¤ë€ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œê·¸ë¨ì´ë‹¤.

í”„ë¡œê·¸ë¨ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì„œ Processor(CPU)ê°€ í•„ìš”í•˜ë‹¤. ìš´ì˜ì²´ì œëŠ” ì‚¬ìš©ìì—ê²Œ ë™ì‹œì— ì—¬ëŸ¬ê°œì˜ í”„ë¡œì„¸ìŠ¤ê°€ ì‹¤í–‰ë˜ê³  ìˆë‹¤ëŠ” ì°©ê°ì„ ì¼ìœ¼í‚¨ë‹¤. ì‚¬ì‹¤ CPUëŠ” process to processë¡œ switchë¥¼ í•˜ë©´ì„œ ì—¬ëŸ¬ê°œì˜ í”„ë¡œê·¸ë¨ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ë‹¤.

ê°ê°ì˜ í”„ë¡œì„¸ìŠ¤ëŠ” address space(core image), process table entryë¥¼ ê°€ì§„ë‹¤.

### Processì˜ ì„¸ê°€ì§€ ìƒíƒœ
1. Running,ì‹¤í–‰
    - ì‹¤ì œë¡œ CPUë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ” ìƒíƒœ
2. Ready,ì¤€ë¹„
    - Runnable, ì¼ì‹œì ìœ¼ë¡œ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ê°€ ì‹¤í–‰ë˜ë„ë¡ ë©ˆì¶°ìˆëŠ” ìƒíƒœ
    - CPUëŠ” processê°„ì— ê³µìœ ë˜ì–´ì•¼ í•œë‹¤.
3. Blocked
    - ì¤‘ë‹¨ëœ ìƒíƒœ, diskê°€ ì½íˆê±°ë‚˜ ì…ë ¥ì´ ë“¤ì–´ì™€ì„œ ì¼ì‹œì ìœ¼ë¡œ runí•  ìˆ˜ ì—†ëŠ” ìƒíƒœ

![stateD](img/processSynchronization/state.png)


## ğŸ« Synchronization
> ê³µìœ  ë°ì´í„°(Shared data)ì— ë‘ ê°œ ì´ìƒì˜ í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‹œì— ì ‘ê·¼í•˜ë©´ data inconsistency(ë°ì´í„° ëª¨ìˆœì„±)ê°€ ë°œìƒ í•  ìˆ˜ ìˆë‹¤.

### Interprocess Communication, í”„ë¡œì„¸ìŠ¤ê°„ í†µì‹ 
- ì„¸ ê°€ì§€ ì´ìŠˆ
    - ì–´ë–»ê²Œ í•œ í”„ë¡œì„¸ìŠ¤ê°€ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì—ê²Œ ì •ë³´ë¥¼ ë„˜ê¸¸ ê²ƒì¸ê°€?
    - ë‘ê°œ ì´ìƒì˜ í”„ë¡œì„¸ìŠ¤ê°€ í•˜ë‚˜ì˜ ë°ì´í„°ì— ë™ì‹œì— ì ‘ê·¼í•˜ì§€ ì•Šë„ë¡ í•  ê²ƒì¸ê°€?
    - ì˜ì¡´ ê´€ê³„ê°€ ì¡´ì¬í•  ë•Œ ì–´ë–»ê²Œ ì ì ˆí•œ ìˆœì„œ ë¶€ì—¬ë¥¼ í•  ê²ƒì¸ê°€?
        - ë§Œì•½ process Aê°€ ë°ì´í„° C ìƒì‚°í•˜ê³ , Bê°€ Cë¥¼ ì¶œë ¥í•˜ëŠ” ì—­í• ì„ ìˆ˜í–‰í•œë‹¤ë©´, BëŠ” Aê°€ ìˆ˜í–‰ëœ í›„ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•œë‹¤.

## ğŸ« Race Conditions
> Race condition(ê²½ìŸ ìƒíƒœ)ì€ ë‘ ê°œ ë˜ëŠ” ì´ìƒì˜ í”„ë¡œì„¸ìŠ¤ê°€ shared dataë¥¼ ë™ì‹œì— ì½ê±°ë‚˜ ì“°ëŠ” ìƒí™©ì—ì„œ ë§ˆì§€ë§‰ ê²°ê³¼ëŠ” ì •í™•íˆ ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ê°€ ì–¸ì œ ìˆ˜í–‰ë˜ì—ˆëŠ”ì§€ì— ë”°ë¼ì„œ ê²°ì •ëœë‹¤.

### Race Condition ë°œìƒ í•  ë•Œ
1. ì»¤ë„ ì‘ì—…ì„ ìˆ˜í–‰ ì¤‘ì— ì¸í„°ëŸ½íŠ¸ê°€ ë°œìƒí•  ë•Œ
2. í”„ë¡œì„¸ìŠ¤ê°€ system callì„ í•˜ì—¬ ì»¤ë„ ëª¨ë“œë¡œ ì§„ì…í•˜ì—¬ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë„ì¤‘ context switchê°€ ë°œìƒí•  ë•Œ
3. ë©€í‹° í”„ë¡œì„¸ì„œì—ì„œ ê³µìœ  ë©”ëª¨ë¦¬ ë‚´ì˜ ì»¤ë„ ë°ì´í„°ì— ì ‘ê·¼í•  ë•Œ


## ğŸ« Critical Region(Critical section)

![cs](img/processSynchronization/cs.png)

- Mutual Exclusion(ìƒí˜¸ë°°ì œ)
    - í•œ í”„ë¡œì„¸ìŠ¤ê°€ Critical regionì— ë“¤ì–´ì˜¤ë©´ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ëŠ” critical regionì— ë“¤ì–´ê°ˆ ìˆ˜ ì—†ë‹¤.
- Critical Region(ì„ê³„êµ¬ì—­)
    - ë©€í‹° í”„ë¡œì„¸ìŠ¤ í™˜ê²½ì—ì„œ ë‘˜ ì´ìƒì˜ í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‹œì— ì ‘ê·¼í•´ì„œëŠ” ì•ˆë˜ëŠ” ê³µìœ  ìì›ì˜ __ì½”ë“œ ì˜ì—­__ ì´ë‹¤.

critical regionì€ ì‹œê°„ì´ ì§€ë‚˜ë©´ ì¢…ë£Œë˜ë©°, ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ê°€ ì„ê³„êµ¬ì—­ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ì„œëŠ” ì§€ì •ëœ ì‹œê°„ë§Œí¼ ëŒ€ê¸°í•´ì•¼ í•œë‹¤. ì´ë•Œ ìŠ¤ë ˆë“œë‚˜ í”„ë¡œì„¸ìŠ¤ê°€ ë°°íƒ€ì ì¸ ì‚¬ìš©ê¶Œì„ ë³´ì¥ë°›ê¸° ìœ„í•´ì„œ ì„¸ë§ˆí¬ì–´ ê°™ì€ ë™ê¸°í™” ë©”ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•œë‹¤.

#### Critical region ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë„¤ ê°€ì§€ ì¡°ê±´
1. Mutual Exclusion 
    - ë‘ê°œì˜ í”„ë¡œì„¸ìŠ¤ëŠ” ë™ì‹œì— critical regionì— ë“¤ì–´ê°ˆ ìˆ˜ ì—†ë‹¤.
2. CPUì˜ ê°¯ìˆ˜ë‚˜ ì„±ëŠ¥ì— ê´€í•˜ì—¬ ì–´ë– í•œ ê°€ì •ë„ í•´ì„œëŠ” ì•ˆëœë‹¤.
3. Critical region ë°–ì— ìˆëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ë‹¤ë¥¸ processë¥¼ blockí•´ì„œëŠ” ì•ˆëœë‹¤.
4. Bounded Waiting(í•œì • ëŒ€ê¸°)
    - ê·¸ ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ë„ critical regionì— ë“¤ì–´ê°€ê¸° ìœ„í•´ ì˜ì›íˆ ê¸°ë‹¤ë ¤ì„œëŠ” ì•ˆëœë‹¤.

ì €ëŠ” ìœ„ ë„¤ ê°€ì§€ë¡œ ë°°ì› ì§€ë§Œ ë‹¤ë¥¸ ê³³ì—ì„œ ì„¸ ê°€ì§€ë¡œ ì •ë¦¬í•œê²Œ ë§ì•„ ì„¸ ê°€ì§€ë„ ì ì–´ë³´ê² ìŠµë‹ˆë‹¤.

#### Critical region ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë„¤ ê°€ì§€ ì¡°ê±´

1. Mutual Exclusion(ìƒí˜¸ë°°ì œ) - í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ê°€ ì„ê³„êµ¬ì—­ì— ìˆë‹¤ë©´ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ëŠ” ë“¤ì–´ê°ˆ ìˆ˜ ì—†ë‹¤.
2. Progress(ì§„í–‰) - ì„ê³„êµ¬ì—­ì— ë“¤ì–´ê°„ í”„ë¡œì„¸ìŠ¤ê°€ ì—†ë‹¤ë©´ ì–´ëŠ í”„ë¡œì„¸ìŠ¤ê°€ ë“¤ì–´ê°ˆ ê²ƒì¸ì§€ ì ì ˆíˆ ì„ íƒí•´ì¤˜ì•¼ í•œë‹¤.
3. Bounded Waiting(í•œì • ëŒ€ê¸°) - ê¸°ì•„ìƒíƒœë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´, í•œ ë²ˆ ë“¤ì–´ê°”ë‹¤ ë‚˜ì˜¨ í”„ë¡œì„¸ìŠ¤ëŠ” ë‹¤ìŒì— ë“¤ì–´ ê°ˆ ë•Œ ì œí•œì„ ì¤€ë‹¤.


## ğŸ« í•´ê²°ì±…
ì„ê³„ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë°©ì‹ì€ ë§ì§€ë§Œ í¬ê²Œ ì •ë¦¬ë¥¼ í•´ë³´ë©´ 
- Disabling Interrupt
- Lock
- Peterson's solution
- TSL instruction(h/w)
- Sleep and Wakeup
- Producer-consumer
- Semaphore
- Monitor 
ë“±ë“± ë§ìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ ì£¼ë¡œ ë‹¤ë£¨ëŠ” ê²ƒì€ ì •í•´ì ¸ ìˆê¸° ë•Œë¬¸ì— ê¶ê¸ˆí•˜ì‹  ë¶„ë“¤ì€ ê°œì¸ì ìœ¼ë¡œ ì°¾ì•„ë³´ì‹œë©´ ë˜ê³  ì œ ìƒê°ì—ëŠ” ë©´ì ‘ì„ ë³´ê¸° ìœ„í•´ì„œ ê¼­ ì•Œì•„ì•¼ í•˜ëŠ” ê°œë…ì€ ì•„ë˜ ì„¸ê°€ì§€ ì •ë„ì¸ ê±° ê°™ìŠµë‹ˆë‹¤.

### Lock (test and set)
> ì†Œí”„íŠ¸ì›¨ì–´ì ì¸ í•´ê²°ë°©ë²•ìœ¼ë¡œ ê³µìœ ë½ì„ ì´ìš©í•œë‹¤.

#### ë™ì‘ ë°©ì‹
1. ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ê°€ critical regionì— ë“¤ì–´ê°€ë ¤ í•  ë•Œ lockì„ ê²€ì‚¬í•œë‹¤.
2. ë§Œì•½ lockì´ 0ì´ë¼ë©´, í”„ë¡œì„¸ìŠ¤ëŠ” lock->1ë¡œ ë°”ê¾¸ê³  critical regionì— ë“¤ì–´ê°„ë‹¤.
3. ë§Œì•½ lockì´ ì´ë¯¸ 1ì´ë¼ë©´, í”„ë¡œì„¸ìŠ¤ëŠ” lockì´ 0ìœ¼ë¡œ ë°”ë€” ë•Œ ê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤.

*Spooler directoryì™€ ê°™ì€ ê²°ì ì„ ê°€ì§€ê³  ìˆë‹¤.

í•˜ì§€ë§Œ ì´ ë°©ì‹ì€ mutual exclusionì„ ì œê³µí•˜ì§€ ëª»í•©ë‹ˆë‹¤.

__ë¬¸ì œ ìƒí™© ì˜ˆì‹œ__
```
1. Aê°€ lockì„ 0ì¸ ê²ƒ í™•ì¸
2. B ì°¨ë¡€ê°€ ë˜ì–´ lockì´ 0ì¸ ê²ƒì„ í™•ì¸í•˜ì—¬ critical regionì— ì§„ì…í•˜ë©´ì„œ,
 lock -> 1ë¡œ ë°”ê¿ˆ
3. í•˜ì§€ë§Œ Aê°€ critical regionì— ë“¤ì–´ê°€ë ¤ê³  í™•ì¸í•œ ê±°ì˜€ì–´ì„œ critical region
ì— ë“¤ì–´ê°€ê³  ë³€ìˆ˜ 1ë¡œ ë°”ê¾¼ë‹¤.
=> A, B ë™ì‹œì— critical regionì— ë“¤ì–´ê°€ê³  ì¡°ê±´ 1ì— ìœ„ë°°
```

### Semaphore

### Semaphore

- ì„¸ë§ˆí¬ì–´ëŠ” ìì›ì˜ ê°œìˆ˜ë¥¼ ëœ»í•œë‹¤.
- ë™ì‹œì— ìì›ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” í—ˆìš©ê°€ëŠ¥í•œ __counterì˜ ê°œìˆ˜__
- ì„¸ë§ˆí¬ì–´ëŠ” ì—¬ëŸ¬ í”„ë¡œì„¸ìŠ¤ë“¤ì— ì˜í•´ __ê³µìœ ë˜ëŠ” ë³€ìˆ˜__ ë¡œ ì •ì˜
- ì´ ë³€ìˆ˜ëŠ” ì˜¤ì§ P, Vë¼ëŠ” atomicí•œ ì—°ì‚°ì— ì˜í•´ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥
- ë¦¬ì†ŒìŠ¤ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” __ì¹´ìš´í„°__ ê°œë…ì´ë‹¤.
- lockì˜ ê²½ìš°ì—ëŠ” 0, 1ë¡œë§Œ êµ¬ë¶„ì„ í–ˆì§€ë§Œ ì„¸ë§ˆí¬ì–´ëŠ” shared data ê°œìˆ˜ë¥¼ ì˜ë¯¸í•œë‹¤. semaphoreëŠ” lockê³¼ëŠ” ë‹¬ë¦¬ 1ë¡œ ì´ˆê¸°í™”í•˜ê³  ì‚¬ìš©ì¤‘ì´ë©´ 0ìœ¼ë¡œ ë°”ë€ë‹¤.
- ì„¸ë§ˆí¬ì–´ëŠ” ì†Œìœ ì˜ ê°œë…ì´ ì—†ë‹¤.(ì¹´ìš´í„°ë¡œ ì—¬ëŸ¬ê°œë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸)
    - ì„¸ë§ˆí¬ì–´ë¥¼ ì†Œìœ í•˜ì§€ ì•Šì€ í”„ë¡œì„¸ìŠ¤ê°€ ì„¸ë§ˆí¬ì–´ë¥¼ í•´ì œí•  ìˆ˜ë„ ìˆëŠ” ë¬¸ì œê°€ ìˆìŒ => mutual exclusion ì´ ë³´ì¥ë˜ì§€ ì•ŠëŠ”ê²Œ ì•„ë‹Œê°€..?
- Semaphore counter ê°¯ìˆ˜ 1ê°œ - binary semaphore, 2 ì´ìƒ - counting semaphore



#### Semaphore ì—°ì‚°

- Down(P) operation
    - ë§Œì•½ ì„¸ë§ˆí¬ì–´ê°€ 0ë³´ë‹¤ í¬ë‹¤ë©´, ê°’ì„ ê°ì†Œì‹œí‚¨ë‹¤.
    - ë§Œì•½ ì„¸ë§ˆí¬ì–´ê°€ ì´ë¯¸ 0ì´ë¼ë©´ processëŠ” down(P) opë¥¼ ëë‚´ì§€ì•Šê³  sleepí•œë‹¤.
- critical region
- up(V) operation
    - ì„¸ë§ˆí¬ì–´ ê°’ì„ ì¦ê°€ì‹œí‚¤ë©´ì„œ ì„¸ë§ˆí¬ì–´ì— ì˜í•´ ë‘ ê°œ ì´ìƒì˜ í”„ë¡œì„¸ìŠ¤ê°€ ìê³  ìˆë‹¤ë©´ ì´ì „ì˜ ì‘ì—…ì„ ëë‚¼ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ìê³  ìˆëŠ” ê²ƒë“¤ì¤‘ì—ì„œ í•˜ë‚˜ë¥¼ ê¹¨ì›Œ ì‘ì—…ì„ ëë‚´ê³  downìƒíƒœë¡œ ê°ˆ ìˆ˜ ìˆê²Œ í•œë‹¤.


```c
// ì„¸ë§ˆí¬ì–´ë¥¼ í™œìš©í•˜ì—¬ producer consumer ë¬¸ì œ í•´ê²° ì½”ë“œ (ì°¸ê³ ë§Œ í•˜ì„¸ìš”!)
#define N 100
typedef int semaphore;
semaphore mutex = 1;
semaphore empty = N;
semaphore full = 0;

void producer(){
    int item;

    while(TRUE){
        item = produce_item();
        down(&empty);
        down(&mutex);
        insert_item(item);
        up(&mutex);
        up(&full);
    }
}

void consumer(){
    int item;
    while(TRUE){
        down(&full);
        down(&mutex);
        item = remove_item();
        up(&mutex);
        up(&empty);
        consume_item(item);
    }
}
```


### Mutex
- ì„¸ë§ˆí¬ì–´ì˜ ê°„ì†Œí™”ëœ ë²„ì „, semaphoreê°€ ì•„ë‹ˆë‹¤.
- Unlock :0, lock :1
- ë®¤í…ìŠ¤ ê°ì²´ë¥¼ ë‘ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
- ì¼ì¢…ì˜ locking ë§¤ì»¤ë‹ˆì¦˜ìœ¼ë¡œ ê³µìœ  ìì›ì— ëŒ€í•œ ì ‘ê·¼ì„ ì¡°ìœ¨í•˜ê¸° ìœ„í•´ lockingê³¼ unlockingì„ low levelì—ì„œ ê´€ë¦¬í•œë‹¤.

```
mutex_lock:
    TSL REGISTER, MUTEX | mutexë¥¼ ë ˆì§€ìŠ¤í„° ê°’ìœ¼ë¡œ ì˜®ê¸°ê³  mutexëŠ” 1ë¡œ ë°”ê¾¼ë‹¤.
    CMP REGISTER, #0 
    JZE ok
    CALL mutex_lock
ok: RET | critical regionì— ë“¤ì–´ê°„ë‹¤.

mutex_unlock:
    MOVE MUTEX #0 | mutexfmf 0ìœ¼ë¡œ ë°”ê¾¼ë‹¤.
    RET
```

## Toilet problem with Mutex&Semaphore (ì˜ˆì œ ëŠë‚Œì…ë‹ˆë‹¤ì‰)

ë™ì‹œì„± í”„ë¡œê·¸ë˜ë°ì˜ ê°€ì¥ í° ìˆ™ì œëŠ” `ê³µìœ ìì› ê´€ë¦¬`ì…ë‹ˆë‹¤. ê³µìœ ìì›ì„ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ê¸° ìœ„í•´ì„œëŠ” ìƒí˜¸ë°°ì œë¥¼ ë‹¬ì„±í•˜ëŠ” ê¸°ë²•ì´ í•„ìš”í•©ë‹ˆë‹¤.

### Mutex
ë®¤í…ìŠ¤ëŠ” `í™”ì¥ì‹¤ì´ í•˜ë‚˜ ë¿ì´ ì—†ëŠ” ì‹ë‹¹`ê³¼ ë¹„ìŠ·í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ì„œ í™”ì¥ì‹¤ì„ ê°€ê¸°ìœ„í•´ ì¹´ìš´í„°ì—ì„œ ì—´ì‡ ë¥¼ ë°›ì•„ ê°€ì•¼ í•œë‹¤ê³  ìƒê°í•©ì‹œë‹¤.

í™”ì¥ì‹¤ì„ ê°€ë ¤ê³  í•˜ëŠ”ë° ì¹´ìš´í„°ì— í‚¤ê°€ ìˆìœ¼ë©´ í™”ì¥ì‹¤ì´ ë¹„ì–´ìˆëŠ” ê²ƒì´ê³  ê·¸ ì—´ì‡ ë¥¼ ì´ìš©í•´ì„œ í™”ì¥ì‹¤ì— ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ğŸ‘‡

> ![m1](img/processSynchronization/m1.png)

í™”ì¥ì‹¤ì—ì„œ í–‰ë³µí•œ ì‹œê°„ì„ ë³´ë‚´ê³  ìˆëŠ”ë° ë‹¤ë¥¸ í…Œì´ë¸”ì—ì„œ ì–´ë–¤ ë‚¨ìê°€ í™”ì¥ì‹¤ì— ê°€ê³  ì‹¶ì–´ì¡ŒìŠµë‹ˆë‹¤. ì´ ë‚¨ìëŠ” ì•„ë¬´ë¦¬ ìš©ë¬´ê°€ ê¸‰í•´ë„ ê¾¹ ì°¸ì•„ì•¼ê² ì£ ? í™”ì¥ì‹¤ì´ í’€ë°©ì´ë‹ˆê¹Œìš”.. ê²°êµ­ ë‚¨ìëŠ” ë‚´ê°€ í™”ì¥ì‹¤ì„ ë‹¤ ì“¸ ë•Œê¹Œì§€ ì¹´ìš´í„°ì—ì„œ ì¸ë‚´ì˜ ì‹œê°„ì„ ë³´ë‚´ì•¼ í•©ë‹ˆë‹¤. 
ğŸ‘‡

> ![m2](img/processSynchronization/m2.png)

ê³§ì´ì–´ ì˜† í…Œì´ë¸”ì— ìˆë˜ ì—¬ìë„ í™”ì¥ì‹¤ì— ê°€ê³  ì‹¶ì€ ê°€ë´ìš”,, ì–´ë–¡í•˜ì§€? ì–´ë–¡í•˜ê¸´ ê¸°ë‹¤ë ¤ì•¼ì£ ,, ì¹´ìš´í„°ì—ì„œ..
ğŸ‘‡

> ![m3](img/processSynchronization/m3.png)

ì´ì œ ë‚´ê°€ í™”ì¥ì‹¤ì—ì„œ ë‚˜ì™”ê³  ì¹´ìš´í„°ì— í‚¤ë¥¼ ëŒë ¤ë†¨ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì•„ê¹Œ ì¸ë‚´ì˜ ì‹œê°„ì„ ë³´ë‚´ë˜ ë„ˆë¬´ ê¸‰í–ˆë˜ ë‚¨ìëŠ” ì¹´ìš´í„°ì— ì˜¬ë ¤ì§„ í‚¤ë¥¼ ë“¤ê³  ë°”ë¡œ í™”ì¥ì‹¤ë¡œ ì§í–‰~
ğŸ‘‡

> ![m4](img/processSynchronization/m4.png)


ì´ê²Œ ë®¤í…ìŠ¤ê°€ ë™ì‘í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. í™”ì¥ì‹¤ì„ ì´ìš©í•˜ëŠ” ì‚¬ëŒë“¤ì„ í”„ë¡œì„¸ìŠ¤ í˜¹ì€ ì“°ë ˆë“œì´ê³  í™”ì¥ì‹¤ì€ ê³µìœ ìì›ì¸ ê²ƒì´ì£ . í™”ì¥ì‹¤ í‚¤ëŠ” ê³µìœ  ìì›ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì–´ë–¤ ì˜¤ë¸Œì íŠ¸ì…ë‹ˆë‹¤. ìš´ì˜ì²´ì œ ìˆ˜ì—… ë•Œ êµìˆ˜ë‹˜ì˜ ë§ì”€ì„ ë”ë“¬ì–´ì„œ ìƒê°ì„ í•´ë³´ë©´ ì´ í™”ì¥ì‹¤ í‚¤ë¥¼ í•˜ë“œì›¨ì–´ì ìœ¼ë¡œ ê´€ë¦¬í•œë‹¤ê³  í•˜ì…¨ë˜ê±° ê°™ì•„ìš”. tsl lock ì²˜ëŸ¼ìš”.! ê·¸ë˜ì„œ ì´ í™”ì¥ì‹¤í‚¤ëŠ” ì¼ë°˜ lockê³¼ëŠ” ë‹¤ë¥¸ ê²ƒì´ë¼ê³  ìƒê°í•´ë„ ì¢‹ì„ê±° ê°™ìŠµë‹ˆë‹¤.
ğŸ‘‡

> ![m5](img/processSynchronization/m5.png)


### Semaphore

ì„¸ë§ˆí¬ì–´ëŠ” ì†ë‹˜ì´ í™”ì¥ì‹¤ì„ ì¢€ ë” ì‰½ê²Œ ì´ìš©í•  ìˆ˜ ìˆëŠ” ìˆ ì§‘ì…ë‹ˆë‹¤. ì„¸ë§ˆí¬ì–´ë¥¼ ì´ìš©í•˜ëŠ” ìˆ ì§‘ í™”ì¥ì‹¤ì—ëŠ” ì—¬ëŸ¬ ê°œì˜ í™”ì¥ì‹¤ ì¹¸ì´ ìˆì–´ìš”.. ë‹¤í–‰ì´ë„¤ìš”. ê·¸ë¦¬ê³  ì¬ë°Œê²Œë„ í™”ì¥ì‹¤ í˜„í™©íŒì´ ìˆë‹¤ê³  ê°€ì •ì„ í–ˆë„¤ìš”.
ğŸ‘‡
> ![s1](img/processSynchronization/s1.png)

ë‚´ê°€ í™”ì¥ì‹¤ì— ê°€ê³  ì‹¶ìœ¼ë©´ ì…êµ¬ì—ì„œ í˜„í™©íŒì„ í†µí•´ ë¹ˆ ì¹¸ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  í˜„í™©íŒì„ n-- ì…ì¥í•´ì£¼ë©´ ë©ë‹ˆë‹¤. ë§Œì•½ ë³¼ ì¼ì„ ë‹¤ ë§ˆì¹˜ë©´ n++ ì‹œì¼œì•¼ê² ì£ ?
ğŸ‘‡
> ![s2](img/processSynchronization/s2.png)

ëª¨ë“  ì¹¸ì— ì‚¬ëŒë“¤ì´ ì°¨ìˆë‹¤ë©´ ë¹ˆ ì¹¸ì˜ ê°œìˆ˜ëŠ” 0ì¸ë°ìš” ì´ë•Œë¶€í„° ë˜ ë‹¤ì‹œ ì¸ë‚´ì˜ ì‹œê°„ì´ ì‹œì‘ë©ë‹ˆë‹¤. ì‚¬ëŒì´ ë‚˜ì˜¬ ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ì£ ..
ğŸ‘‡
> ![s3](img/processSynchronization/s3.png)

ì‚¬ëŒë“¤ì´ ë‚˜ì˜¬ ë•Œ ë§ˆë‹¤ ë¹ˆ ì¹¸ì˜ ê°œìˆ˜++ ì‹œì¼œì¤˜ì•¼ í•˜ê³  ê¸°ë‹¤ë¦¬ë˜ ì‚¬ëŒì€ ë‹¤ì‹œ ë¹ˆ ì¹¸ì˜ ê°œìˆ˜-- í•˜ê³  ì…ì¥í•˜ì…”ì•¼ í•©ë‹ˆë‹¤.
ğŸ‘‡
> ![s4](img/processSynchronization/s4.png)

ì •ë¦¬í•˜ë©´ 
mutex <= í•œ ì“°ë ˆë“œ, í”„ë¡œì„¸ìŠ¤ì— ì˜í•´ ì†Œìœ ë˜ëŠ” í‚¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œí•œ mutual exclusion ê¸°ë²•
semaphore <= signaling mechanismìœ¼ë¡œ í˜„ì¬ ê³µìœ ìì›ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ìŠ¤ë ˆë“œ í”„ë¡œì„¸ìŠ¤ì˜ ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’ì„ ë‘ì–´ ìƒí˜¸ë°°ì œë¥¼ ë‹¬ì„±í•œë‹¤ê³  í•©ë‹ˆë‹¤.

### Monitor
- Mutexì™€ Condition Variablesë¥¼ ê°€ì§€ê³  ìˆëŠ” synchronization ë§¤ì»¤ë‹ˆì¦˜ì´ë‹¤.
- Mutexì™€ monitorëŠ” ìƒí˜¸ë°°ì œë¥¼ í•¨ìœ¼ë¡œì¨ ì„ê³„êµ¬ì—­ì— í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë§Œ ë“¤ì–´ê°ˆ ìˆ˜ ìˆë‹¤.(ì„¸ë§ˆí¬ì–´ëŠ” ì—¬ëŸ¬ê°œì˜ í”„ë¡œì„¸ìŠ¤ ë“¤ì–´ê°ˆ ìˆ˜ ìˆìŒ.)

### Semaphore vs. Mutex vs. Monitor
> ì•„ì§ ì•ˆëë‚¬ìŠµë‹ˆë‹¤... ì•„ì§ í•œë°œ ë‚¨ì•˜ìŠµë‹ˆë‹¤...

### ğŸ“š ì°¸ê³ 

[Critical Region](https://dduddublog.tistory.com/25)

[Process sync](https://jungwoon.github.io/os/2019/07/31/Process-Synchronization.html)

[Mutex&semaphore](https://worthpreading.tistory.com/90)

[Monitor,mutex,semaphore](https://worthpreading.tistory.com/90)