# Socket

## Http review
- HTTP 통신은 클라이언트 서버가 요청, 응답을 하는 **단방향 통신**이다.
- json, xml, image, html 등등 파일을 전송한다.
- 응답을 받으면 connetction이 끊어진다. 하지만 `keep alive` 옵션으로 일정 시간동안 연결을 유지할 수 있다.

## Socket
- 소켓 통신은 두 프로그램이 서로 데이터를 주고 받을 수 있도록 양쪽에 생성되는 통신 단자입니다. 
- 소켓 통신은 서버와 클라이언트 양방향 연결이 이루어지는 통신으로, 서버와 클라이언트 모두 요청과 응답을 할 수 있는 방식이다. (**양방향 통신**) 
- 이런 장점으로 스트리밍이나 실시간 채팅 등 **실시간으로 데이터를 주고 받아야 하는 경우**에 connection을 자주 맺고 끊는 http 통신보다 소켓 통신이 적합하다. 
- 소켓 통신은 http보다 리소스가 많이 소모된다.(연결을 계속 하고 있기 때문.)

## RestAPI vs Socket
- 메세지를 주고 받는 예시

### Rest API
restAPI는 http 방식으로 동작하기(단방향 통신) 때문에 server에서 request를 보낼 수 없기 때문에 메시지가 새로 들어와도 client에게 알릴 방법은 없고 client가 get 요청을 server에게 지속적으로 보내서 확인하는 수 밖에 없다.

- **short polling**
    - get 방식을 통해서 새로운 메시지가 있는지 짧은 시간 텀(타이머)을 가지고 확인하는 방식이다.
    - latency delay가 발생
    - http로 통신하기 때문에 request가 발생할 때마다 server로 요청하게 되는데 이 때문에 서버에 부하가 발생
- **long polling**
    - 매 x초마다 검사를 하는 것이 아니고 delay를 줘서 만약 새로운 메시지가 수신될 때마다 request를 하는 방식이다. 
    - short polling에 비해서 좋은 방식이지만 적용시키기에 다소 어렵고 백엔드에서 더 많은 작업이 요구된다.

### Websocket
websocket 통신은 초기에 연결이 성립됐다는 것을 client가 서버에게 알린다. 

> 만약 존이 메리에게 메시지를 보내게되면 메리 측에서는 지속적으로 request를 보낼 필요가 없이 server에 메리에게 송신된 메시지가 있으면 즉시 메시지를 메리에게 전달하게된다. 

이처럼 websocket 통신을 이용하면 end to end가 연결된 통신을 하게되어 서버의 부하를 줄임과 동시에 http를 통해 송수신 할때보다 원할하게 통신할 수 있다.(**양방향 통신**)

